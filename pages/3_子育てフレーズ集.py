"""
å­è‚²ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºé›†
ã‚ˆãä½¿ã†ãƒ¯ãƒ¼ãƒ‰ä¸€è¦§ã‚’ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ç®¡ç†ã—ã€æ¤œç´¢ãƒ»ã‚³ãƒ”ãƒ¼ã§ãã‚‹ã‚¢ãƒ—ãƒª
"""
from typing import Dict, List
import streamlit as st


# å­è‚²ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºãƒ‡ãƒ¼ã‚¿
PARENTING_PHRASES: Dict[str, List[str]] = {
    "æœã®æŒ¨æ‹¶ãƒ»èµ·åºŠ": [
        "ãŠã¯ã‚ˆã†ï¼ã‚ˆãçœ ã‚ŒãŸï¼Ÿ",
        "ä»Šæ—¥ã‚‚å…ƒæ°—ã«éã”ãã†ã­",
        "æœã”ã¯ã‚“é£Ÿã¹ã‚ˆã†ã­",
        "ãŠç€æ›¿ãˆã—ã‚ˆã†ã‹",
        "é¡”æ´—ãŠã†ã­",
        "ã‚‚ã†æœã ã‚ˆã€èµ·ãã‚‹æ™‚é–“ã ã‚ˆ",
        "ãŠæ—¥æ§˜ãŒå‘¼ã‚“ã§ã‚‹ã‚ˆ",
        "ã„ã„æœã ã­ï¼",
    ],
    "é£Ÿäº‹": [
        "ã„ãŸã ãã¾ã™",
        "ã”ã¡ãã†ã•ã¾ã§ã—ãŸ",
        "ã‚‚ãã‚‚ãã—ã‚ˆã†ã­",
        "ã‚ˆãå™›ã‚“ã§é£Ÿã¹ã‚ˆã†ã­",
        "ãŠã„ã—ã„ã­",
        "ã‚ã¨ä¸€å£é ‘å¼µã‚ã†",
        "ãŠé‡èœã‚‚é£Ÿã¹ã‚ˆã†ã­",
        "ã“ã¼ã•ãªã„ã‚ˆã†ã«æ°—ã‚’ã¤ã‘ã¦ã­",
        "ãŠè¡Œå„€ã‚ˆãåº§ã‚ã†ã­",
        "ã‚¹ãƒ—ãƒ¼ãƒ³ä¸Šæ‰‹ã ã­",
        "è‡ªåˆ†ã§é£Ÿã¹ã‚‰ã‚Œã‚‹ã‹ãªï¼Ÿ",
        "ãŠæ°´é£²ã‚‚ã†ã­",
    ],
    "éŠã³ãƒ»å¤–å‡º": [
        "ãŠå¤–ã§éŠã¼ã†ã‹",
        "å…¬åœ’è¡Œã“ã†ã­",
        "ãŠå‹é”ã¨ä»²è‰¯ãã­",
        "é †ç•ªå®ˆã‚ã†ã­",
        "è²¸ã—ã¦ã£ã¦è¨€ãŠã†ã­",
        "ã‚ã‚ŠãŒã¨ã†ã£ã¦è¨€ãŠã†ã­",
        "ä¸€ç·’ã«éŠã¼ã†",
        "æ¥½ã—ã„ã­",
        "æ°—ã‚’ã¤ã‘ã¦éŠã‚“ã§ã­",
        "ã‚‚ã†å°‘ã—ã§å¸°ã‚‹ã‚ˆ",
        "ãŠç‰‡ä»˜ã‘ã—ã‚ˆã†ã­",
        "ãŠé´å±¥ã“ã†ã­",
        "å¸½å­ã‹ã¶ã‚ã†ã­",
    ],
    "åŠ±ã¾ã—ãƒ»ã»ã‚ã‚‹": [
        "ã™ã”ã„ã­ï¼",
        "ã‚ˆãã§ããŸã­ï¼",
        "é ‘å¼µã£ãŸã­ï¼",
        "ãˆã‚‰ã„ã­",
        "ã‹ã£ã“ã„ã„ã­",
        "ã•ã™ãŒã ã­",
        "ãã®èª¿å­ï¼",
        "ä¸Šæ‰‹ã ã­",
        "ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã­",
        "æˆé•·ã—ãŸã­",
        "ãƒãƒ/ãƒ‘ãƒ‘å¬‰ã—ã„ã‚ˆ",
        "ã„ã„å­ã ã­",
        "å¤§å¥½ãã ã‚ˆ",
        "ã‚ã‚ŠãŒã¨ã†",
    ],
    "ã—ã¤ã‘ãƒ»æ³¨æ„": [
        "ãã‚Œã¯ãƒ€ãƒ¡ã ã‚ˆ",
        "å±ãªã„ã‹ã‚‰ã‚„ã‚ã‚ˆã†ã­",
        "ãŠç´„æŸå®ˆã‚ã†ã­",
        "å„ªã—ãã—ã‚ˆã†ã­",
        "å©ã‹ãªã„ã§ã­",
        "ã‚‚ã†ä¸€åº¦è€ƒãˆã¦ã¿ã‚ˆã†",
        "ã©ã†ã—ãŸã‚‰ã„ã„ã‹ãªï¼Ÿ",
        "ã”ã‚ã‚“ãªã•ã„ã—ã‚ˆã†ã­",
        "é™ã‹ã«ã—ã‚ˆã†ã­",
        "è½ã¡ç€ã„ã¦",
        "æ·±å‘¼å¸ã—ã‚ˆã†ã‹",
        "æ¬¡ã¯æ°—ã‚’ã¤ã‘ã‚ˆã†ã­",
    ],
    "ãŠé¢¨å‘‚": [
        "ãŠé¢¨å‘‚å…¥ã‚ã†ã­",
        "ä½“æ´—ãŠã†ã­",
        "é ­æ´—ã†ã‚ˆ",
        "ç›®ã¤ã¶ã£ã¦ã­",
        "æ°—æŒã¡ã„ã„ã­",
        "ãã‚Œã„ã«ãªã£ãŸã­",
        "ã‚‚ã†å°‘ã—ã§å‡ºã‚ˆã†ã­",
        "æ¹¯èˆ¹ã«å…¥ã‚ã†ã‹",
        "æ¸©ã¾ã‚ã†ã­",
        "ãŠé¢¨å‘‚ã‹ã‚‰ä¸ŠãŒã‚ã†",
    ],
    "å°±å¯ãƒ»å¤œ": [
        "ãŠã‚„ã™ã¿ãªã•ã„",
        "ã„ã„å¤¢è¦‹ã¦ã­",
        "æ˜æ—¥ã‚‚æ¥½ã—ã„æ—¥ã«ãªã‚‹ã‚ˆ",
        "ã‚‚ã†å¯ã‚‹æ™‚é–“ã ã‚ˆ",
        "æ­¯ç£¨ãã—ã‚ˆã†ã­",
        "ãƒ‘ã‚¸ãƒ£ãƒç€ã‚ˆã†ã­",
        "çµµæœ¬èª­ã‚‚ã†ã‹",
        "ãŠå¸ƒå›£å…¥ã‚ã†ã­",
        "é›»æ°—æ¶ˆã™ã‚ˆ",
        "ã¾ãŸæ˜æ—¥ã­",
        "ä»Šæ—¥ã‚‚æ¥½ã—ã‹ã£ãŸã­",
    ],
    "ãƒˆã‚¤ãƒ¬ãƒ»ãŠã‚€ã¤": [
        "ãƒˆã‚¤ãƒ¬è¡Œã“ã†ã­",
        "ãŠã—ã£ã“å‡ºã‚‹ï¼Ÿ",
        "ã†ã‚“ã¡å‡ºãŸï¼Ÿ",
        "æ•™ãˆã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†",
        "ãŠã‚€ã¤æ›¿ãˆã‚ˆã†ã­",
        "ã™ã£ãã‚Šã—ãŸã­",
        "ãƒˆã‚¤ãƒ¬é ‘å¼µã£ãŸã­",
        "æ¬¡ã‚‚ãƒˆã‚¤ãƒ¬ã§ã§ãã‚‹ã‹ãª",
    ],
    "ãŠå‡ºã‹ã‘æº–å‚™": [
        "ãŠå‡ºã‹ã‘ã™ã‚‹ã‚ˆ",
        "æº–å‚™ã—ã‚ˆã†ã­",
        "ãŠç€æ›¿ãˆã—ã‚ˆã†ã‹",
        "è·ç‰©æŒã£ãŸï¼Ÿ",
        "å¿˜ã‚Œç‰©ãªã„ï¼Ÿ",
        "è¡Œã£ã¦ãã¾ã™",
        "ãŸã ã„ã¾",
        "ãŠå¸°ã‚Šãªã•ã„",
        "æ¥½ã—ã‹ã£ãŸã­",
    ],
    "æ„Ÿæƒ…ã®ã‚µãƒãƒ¼ãƒˆ": [
        "ã©ã†ã—ãŸã®ï¼Ÿ",
        "å¤§ä¸ˆå¤«ã ã‚ˆ",
        "ãƒãƒ/ãƒ‘ãƒ‘ãŒã„ã‚‹ã‚ˆ",
        "æ€–ããªã„ã‚ˆ",
        "æ³£ã„ã¦ã‚‚ã„ã„ã‚ˆ",
        "ç—›ã‹ã£ãŸã­",
        "æ‚²ã—ã‹ã£ãŸã­",
        "å¬‰ã—ã„ã­",
        "å«Œã ã£ãŸã‚“ã ã­",
        "ã‚ã‹ã‚‹ã‚ˆ",
        "ãŠè©±èã‹ã›ã¦",
        "ä¸€ç·’ã«ã„ã‚‹ã‹ã‚‰ã­",
    ],
    "ãŠæ‰‹ä¼ã„ãƒ»ç”Ÿæ´»ç¿’æ…£": [
        "ãŠæ‰‹ä¼ã„ã—ã¦ãã‚Œã‚‹ï¼Ÿ",
        "ä¸€ç·’ã«ã‚„ã‚ã†ã‹",
        "è‡ªåˆ†ã§ã‚„ã£ã¦ã¿ã‚ˆã†",
        "ã§ãã‚‹ã‹ãªï¼Ÿ",
        "ã‚†ã£ãã‚Šã§ã„ã„ã‚ˆ",
        "æ‰‹æ´—ãŠã†ã­",
        "ã†ãŒã„ã—ã‚ˆã†ã­",
        "é¼»ã‹ã‚‚ã†ã­",
        "ãƒãƒ³ã‚«ãƒä½¿ãŠã†ã­",
    ],
}


def filter_phrases(phrases_dict: Dict[str, List[str]], search_query: str) -> Dict[str, List[str]]:
    """
    æ¤œç´¢ã‚¯ã‚¨ãƒªã«åŸºã¥ã„ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

    Args:
        phrases_dict: ãƒ•ãƒ¬ãƒ¼ã‚ºè¾æ›¸
        search_query: æ¤œç´¢ã‚¯ã‚¨ãƒª

    Returns:
        ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ•ãƒ¬ãƒ¼ã‚ºè¾æ›¸
    """
    if not search_query:
        return phrases_dict

    filtered = {}
    search_lower = search_query.lower()

    for category, phrases in phrases_dict.items():
        # ã‚«ãƒ†ã‚´ãƒªåãŒæ¤œç´¢ã«ãƒãƒƒãƒã™ã‚‹å ´åˆã€ãã®ã‚«ãƒ†ã‚´ãƒªå…¨ä½“ã‚’å«ã‚ã‚‹
        if search_lower in category.lower():
            filtered[category] = phrases
        else:
            # ãƒ•ãƒ¬ãƒ¼ã‚ºå†…ã‚’æ¤œç´¢
            matching_phrases = [p for p in phrases if search_lower in p.lower()]
            if matching_phrases:
                filtered[category] = matching_phrases

    return filtered


def main() -> None:
    """ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³"""

    # ãƒšãƒ¼ã‚¸è¨­å®š
    st.set_page_config(
        page_title="å­è‚²ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºé›†",
        page_icon="ğŸ‘¶",
        layout="wide",
        initial_sidebar_state="expanded"
    )

    # ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®åˆæœŸåŒ–
    if 'selected_phrase' not in st.session_state:
        st.session_state.selected_phrase = ""
    if 'copied' not in st.session_state:
        st.session_state.copied = False

    # ãƒ˜ãƒƒãƒ€ãƒ¼
    st.title("ğŸ‘¶ å­è‚²ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºé›†")
    st.subheader("ã‚ˆãä½¿ã†ãƒ¯ãƒ¼ãƒ‰ã‚’ã™ãã«ã‚³ãƒ”ãƒ¼&é€ä¿¡")

    st.markdown("""
    å­è‚²ã¦ã§ã‚ˆãä½¿ã†ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’é›†ã‚ã¾ã—ãŸã€‚ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰é¸ã‚“ã ã‚Šã€
    æ¤œç´¢ã—ãŸã‚Šã—ã¦ã€ã™ãã«LINEãªã©ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é€ä¿¡ã§ãã¾ã™ã€‚
    """)

    st.divider()

    # ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼šæ¤œç´¢ã¨ã‚«ãƒ†ã‚´ãƒªé¸æŠ
    with st.sidebar:
        st.header("ğŸ” æ¤œç´¢ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼")

        # æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹
        search_query = st.text_input(
            "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢",
            placeholder="ä¾‹: ãŠã¯ã‚ˆã†ã€é£Ÿäº‹ã€ãŠé¢¨å‘‚"
        )

        st.divider()

        # ã‚«ãƒ†ã‚´ãƒªé¸æŠ
        st.subheader("ğŸ“‚ ã‚«ãƒ†ã‚´ãƒª")
        categories = ["ã™ã¹ã¦"] + list(PARENTING_PHRASES.keys())
        selected_category = st.radio(
            "ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠ",
            categories,
            label_visibility="collapsed"
        )

        st.divider()

        # çµ±è¨ˆæƒ…å ±
        st.subheader("ğŸ“Š çµ±è¨ˆ")
        total_phrases = sum(len(phrases) for phrases in PARENTING_PHRASES.values())
        st.metric("ç·ãƒ•ãƒ¬ãƒ¼ã‚ºæ•°", f"{total_phrases}å€‹")
        st.metric("ã‚«ãƒ†ã‚´ãƒªæ•°", f"{len(PARENTING_PHRASES)}å€‹")

    # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢
    # ãƒ•ãƒ¬ãƒ¼ã‚ºã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    if selected_category == "ã™ã¹ã¦":
        display_phrases = PARENTING_PHRASES
    else:
        display_phrases = {selected_category: PARENTING_PHRASES[selected_category]}

    # æ¤œç´¢ã‚¯ã‚¨ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    if search_query:
        display_phrases = filter_phrases(display_phrases, search_query)

    # ãƒ•ãƒ¬ãƒ¼ã‚ºãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
    if not display_phrases:
        st.warning("æ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ•ãƒ¬ãƒ¼ã‚ºãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")
        return

    # é¸æŠã•ã‚ŒãŸãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¡¨ç¤ºï¼ˆä¸Šéƒ¨ã«å›ºå®šï¼‰
    if st.session_state.selected_phrase:
        st.success("é¸æŠä¸­ã®ãƒ•ãƒ¬ãƒ¼ã‚º:")
        col1, col2 = st.columns([4, 1])
        with col1:
            st.code(st.session_state.selected_phrase, language=None)
        with col2:
            if st.button("ğŸ—‘ï¸ ã‚¯ãƒªã‚¢", use_container_width=True):
                st.session_state.selected_phrase = ""
                st.rerun()

        st.info("ğŸ’¡ ä¸Šã®ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã€LINEãªã©ã§é€ä¿¡ã§ãã¾ã™ã€‚")
        st.divider()

    # ãƒ•ãƒ¬ãƒ¼ã‚ºä¸€è¦§ã®è¡¨ç¤º
    st.header("ğŸ“ ãƒ•ãƒ¬ãƒ¼ã‚ºä¸€è¦§")

    # ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«è¡¨ç¤º
    for category, phrases in display_phrases.items():
        with st.expander(f"**{category}** ({len(phrases)}å€‹)", expanded=True):
            # 2åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¡¨ç¤º
            cols = st.columns(2)

            for idx, phrase in enumerate(phrases):
                col_idx = idx % 2
                with cols[col_idx]:
                    # ãƒœã‚¿ãƒ³ã¨ã—ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¡¨ç¤º
                    if st.button(
                        phrase,
                        key=f"{category}_{idx}",
                        use_container_width=True,
                        type="secondary"
                    ):
                        st.session_state.selected_phrase = phrase
                        st.session_state.copied = False
                        st.rerun()

    st.divider()

    # ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰
    with st.expander("ğŸ“– ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰", expanded=False):
        st.markdown("""
        ### åŸºæœ¬çš„ãªä½¿ã„æ–¹

        1. **ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰é¸ã¶**: å·¦ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠ
        2. **æ¤œç´¢ã™ã‚‹**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰çµã‚Šè¾¼ã¿
        3. **ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’é¸æŠ**: ä½¿ã„ãŸã„ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ã‚¯ãƒªãƒƒã‚¯
        4. **ã‚³ãƒ”ãƒ¼ã—ã¦é€ä¿¡**: è¡¨ç¤ºã•ã‚ŒãŸãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã§LINEãªã©ã«é€ä¿¡

        ### ãƒ’ãƒ³ãƒˆ

        - ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ä¸Šéƒ¨ã«é¸æŠä¸­ã®ãƒ•ãƒ¬ãƒ¼ã‚ºãŒè¡¨ç¤ºã•ã‚Œã¾ã™
        - è¤‡æ•°ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™
        - ã‚ˆãä½¿ã†ãƒ•ãƒ¬ãƒ¼ã‚ºã¯æ¤œç´¢ã§ç´ æ—©ãè¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™

        ### ã“ã‚“ãªå ´é¢ã§ä¾¿åˆ©

        - ä¿è‚²åœ’ã®å…ˆç”Ÿã¸ã®é€£çµ¡
        - ç¥–çˆ¶æ¯ã¸ã®å­è‚²ã¦ä¾é ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        - ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®å­è‚²ã¦å…±æœ‰
        - ãƒ™ãƒ“ãƒ¼ã‚·ãƒƒã‚¿ãƒ¼ã¸ã®æŒ‡ç¤º
        """)

    # ãƒ•ãƒƒã‚¿ãƒ¼
    st.divider()
    st.markdown("""
    <div style='text-align: center; color: #666;'>
        <small>
        å­è‚²ã¦ãƒ•ãƒ¬ãƒ¼ã‚ºé›† - psychoApps<br>
        å­è‚²ã¦ã‚’å¿œæ´ã—ã¾ã™ ğŸ‘¶
        </small>
    </div>
    """, unsafe_allow_html=True)


if __name__ == "__main__":
    main()
